import brownie
import pytest
from brownie import accounts
from brownie.test import given, strategy


def test_empty_encode_actions(argobytes_atomic_trade):
    encoded_actions = argobytes_atomic_trade.encodeActions(
        [],
        [],
        []
    )

    expected = "0x00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000"

    assert encoded_actions == expected


def test_encode_approve_action(argobytes_atomic_trade, usdc_erc20, dai_erc20):
    some_address = "0x5d3a536E4D6DbD6114cc1Ead35777bAB948E3643"

    approve_dai = dai_erc20.approve.encode_input(some_address, 1e18)

    print("approve_dai calldata:", approve_dai)

    approve_usdc = usdc_erc20.approve.encode_input(some_address, 1e18)

    print("approve_usdc calldata:", approve_usdc)

    encoded_actions = argobytes_atomic_trade.encodeActions(
        [dai_erc20, usdc_erc20],
        [approve_dai, approve_usdc],
        [False, False],
    )

    expected = "0x00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001200000000000000000000000006b175474e89094c44da98b954eedeac495271d0f000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044095ea7b30000000000000000000000005d3a536e4d6dbd6114cc1ead35777bab948e36430000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044095ea7b30000000000000000000000005d3a536e4d6dbd6114cc1ead35777bab948e36430000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000"

    print("encoded_actions:", encoded_actions)

    assert encoded_actions == expected
